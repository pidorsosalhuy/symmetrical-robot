name: Simple SSHX Tunnel

on:
  workflow_dispatch:

jobs:
  sshx:
    runs-on: ubuntu-latest
    
    steps:
    - name: Install and start SSHX
      run: |
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º SSHX
        curl -sSf https://sshx.io/get | sh
        echo "‚úÖ SSHX installed"
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º SSHX –≤ —Ñ–æ–Ω–µ –∏ –ø–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫—É
        sshx | head -n 5 > sshx.log &
        echo "üöÄ SSHX started in background"
        
        # –ñ–¥–µ–º –ø–æ—è–≤–ª–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏
        sleep 10
        
        # –ò—â–µ–º —Å—Å—ã–ª–∫—É –≤ –ª–æ–≥–µ
        SSHX_URL=$(grep -o 'https://[^ ]*' sshx.log | head -1)
        echo "üîó Tunnel URL: $SSHX_URL"
        echo "SSHX_URL=$SSHX_URL" >> $GITHUB_ENV

    - name: Send to Telegram
      run: |
        curl -s -X POST "https://api.telegram.org/bot8179030443:AAEL8dF4cxeAQ3bLbsb_CrAHI2nfcWK12XE/sendMessage" \
          -d chat_id="7309086003" \
          -d text="‚úÖ SSHX tunnel: $SSHX_URL" \
          -d disable_web_page_preview=false

    - name: Wait 6 hours
      run: |
        echo "‚è≥ Waiting 6 hours..."
        sleep 21600
        echo "‚úÖ Done"
