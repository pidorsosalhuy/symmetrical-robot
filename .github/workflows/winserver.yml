name: Remote Desktop Tunnel via Localtunnel

on: [workflow_dispatch]

jobs:
  rdp:
    runs-on: windows-latest
    timeout-minutes: 360

    steps:
      - name: Install Localtunnel
        run: npm install -g localtunnel

      - name: Configure and Enable RDP
        run: |
          net user /add githubuser SecureRDPPass123!
          net localgroup administrators githubuser /add
          net localgroup "Remote Desktop Users" githubuser /add

      - name: Start Localtunnel for RDP
        run: |
          lt --port 3389 --subdomain your-unique-rdp-name-1234 | Out-File -FilePath localtunnel_url.txt
          Get-Content localtunnel_url.txt
          Start-Sleep -Seconds 21600
